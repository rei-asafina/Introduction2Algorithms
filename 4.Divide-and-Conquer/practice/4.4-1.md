<!--
<script type="text/javascript" async
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML">
</script>
-->
>次の漸化式に対する再帰木を描き、漸化式の漸近的上界を推測し、置き換え法を用いて、その答えを検証せよ。

### a. $T(n)=T(n/2)+n^3$


| レベル | 引数 | コスト（$T(n_i) = n_i^3$） |
|--------|------|-------------------------------|
| 0      | $n$     | $n^3$                         |
| 1      | $n/2$   | $\frac{n^3}{8}$              |
| 2      | $n/4$   | $\frac{n^3}{64}$             |
| 3      | $n/8$   | $\frac{n^3}{512}$            |
| ...    | $n/2^i$ | $\frac{n^3}{8^i}$            |

部分問題のサイズが1になるのは、 $\frac{n^3}{8^i} = 1$ 、 すなわち、 $i=\log_2n$ であり、これが木の高さになる。

$$
T(n) = \sum_{i=0}^{\log_2 n} \frac{n^3}{8^i}
$$

$$
T(n) \leq n^3 \cdot \sum_{i=0}^\infty \left( \frac{1}{8} \right)^i = n^3 \cdot \frac{1}{1 - \frac{1}{8}} = n^3 \cdot \frac{8}{7}
$$

よって、上界は、

$$
T(n) = \Theta(n^3)
$$

となる。

また、置き換え法で検証すると、

$$
T(n) = T(n/2) + n^3 \leq \frac{c}{8} n^3 + n^3 = \left(\frac{c}{8} + 1\right) n^3 = O(n^3)
$$

となる。

### b. $T(n)=4T(n/3)+n$


| レベル | 引数   | コスト（$T(n_i)$）          |
|--------|--------|--------------------------------|
| 0      | $n$ | $n$                        |
| 1      | $n/3$ | $4 \times \frac{n}{3}$   |
| 2      | $n/9$ | $4^2 \times \frac{n}{9}$  |
| 3      | $n/27$ | $4^3 \times \frac{n}{27}$|
| ...    | $n/3^i$ | $4^i \times \frac{n}{3^i}$ |

部分問題のサイズが1になるのは、 $\frac{n}{3^i} = 1$ 、 すなわち、 $i=\log_3n$ であり、これが木の高さになる。

$$
T(n) = \sum_{i=0}^{\log_3 n} n(\frac{4}{3})^i
$$

$$
T(n) \leq n \cdot \sum_{i=0}^\infty \left( \frac{4}{3} \right)^i
$$

よって、上界は、

$$
T(n) = n \frac{(4/3)^{\log_3 n} - 1}{(4/3) - 1} \\
= 3n((4/3)^{\log_3 n} - 1) \\
= 3n(n^{\log_3(4/3)} - 1) \\
= O(n^{\log_3 4})
$$

置き換え法を用いて、推測した上界 $O(n^{\log_3 4})$ を検証する。

まず、$T(n) \le cn^{\log_3 4}$ と仮定する。

$$
T(n) = 4T(n/3) + n
$$

$$
T(n) \le 4c(n/3)^{\log_3 4} + n \\
= 4c(n^{\log_3 4}/4) + n \\
= cn^{\log_3 4} + n \\
= cn^{\log_3 4} + cn^{\log_3 4} \\
\le 2cn^{\log_3 4} \\
$$

よって、

$$
T(n) = O(n^{\log_3 4})
$$

が成立する。

### c. $T(n)=4T(n/2)+n$

| レベル $i$ | 部分問題のサイズ $n_i$ | 部分問題数 | 各部分のコスト | 合計コスト |
|--------------|---------------------------|--------------|------------------|-------------|
| 0            | $n$                     | 1            | $n$            | $n$       |
| 1            | $n/2$                   | 4            | $n/2$          | $4 \cdot n/2 = 2n$ |
| 2            | $n/4$                   | 16           | $n/4$          | $16 \cdot n/4 = 4n$ |
| 3            | $n/8$                   | 64           | $n/8$          | $64 \cdot n/8 = 8n$ |
| ...          | $n/2^i$                 | $4^i$      | $n/2^i$        | $n \cdot (4/2)^i = n \cdot 2^i$ |

最終レベル（葉）では部分問題のサイズが1になるので

$$
\frac{n}{2^i} = 1 \Rightarrow i = \log_2 n
$$

再帰木全体のコストは

$$
T(n) = \sum_{i=0}^{\log_2 n} n \cdot 2^i
= n \cdot \sum_{i=0}^{\log_2 n} 2^i
$$

これは等比数列の和なので

$$
T(n) = n \cdot (2^{\log_2 n + 1} - 1)
= n \cdot (2n - 1) = 2n^2 - n
$$

$T(n) \leq c n^2$ と仮定する

$$
T(n) = 4T(n/2) + n
\leq 4 \cdot c \cdot (n/2)^2 + n
= 4c \cdot \frac{n^2}{4} + n
= c n^2 + n \leq c n^2 + n
$$

### d. $T(n)=3T(n-1)+1$

| レベル $i$ | 引数 | コスト |
|-------------|------|--------|
| 0           | $n$   | $1$    |
| 1           | $n-1$ | $3 \cdot 1$ |
| 2           | $n-2$ | $3^2 \cdot 1$ |
| 3           | $n-3$ | $3^3 \cdot 1$ |
| ...         | ...  | ...    |
| $n-1$     | $1$   | $3^{n-1} \cdot 1$ |

よって、全体のコストは：

$$
T(n) = \sum_{i=0}^{n-1} 3^i = 3^0 + 3^1 + 3^2 + \dots + 3^{n-1}
$$

これは等比数列の和なので、

$$
\sum_{i=0}^{n-1} 3^i = \frac{3^n - 1}{2}
$$

したがって、

$$
T(n) = \Theta(3^n)
$$

置き換え法で検証する。

ある定数 $c > 0$ が存在して、すべての $k < n$ に対して

$$
T(k) \leq c \cdot 3^k
$$

が成り立つと仮定する。

十分大きな $n$ に対して $1 \leq \varepsilon \cdot 3^n$ が成り立つので：

$$
T(n) \leq (c + \varepsilon) \cdot 3^n
$$

$$
T(n) = O(3^n)
$$
