<!--
<script type="text/javascript" async
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML">
</script>
-->

## バブルソートの正当性
>バブルソートは人気があるが、非効率なソートアルゴリズムである。バブルソートは隣接要素が逆順になっていれば、それらの位置を交換する操作を繰り返すことでソートを実現する。次の手続き `BUBLESORT` は配列 $A[1:n]$ をソートする。

```
BUBLESORT(A,n)
1. for i to n-1
      for j = n downto i+1
          if (A[j]<A[j-1])
              A[j] と A[j-1] を交換する
```
>a. $A'$ を $BUBLESORT(A)$ の出力とする。 $BUBBLESORT$ の正当性を証明するには、 $BUBLESORT$ が停止し、かつ、 

$$
A'[1] \leq A'[2] \leq \cdots \leq A'[n] \tag{2-5}
$$ 


>が成立すつことを証明しなければならない。 $BUBLESORT$ が実際にソートすることを証明するには他に何を証明する必要があるか。

出力配列 $A'$ には元の配列 $A$ と同じ要素がすべて含まれていること。

次の2つの問では、不等式(2.5)を証明する。
>b.第2~4行の `for` ループに対するループ不変式を正確に記述し、このループ不変式が成立することを証明せよ。ただし、本章で示したループ不変式の証明の構造に従って証明すること。

- 初期条件
  - 内側ループの最初の反復で $j=n$ となる。
  - 内側ループの最初の反復で $A[n]$ は単一要素なのでソート済みとなる。
- ループ内条件
  - $A[j]<A[j−1]$ ならば、交換によって $A[j−1]$ と $A[j]$ が正しい位置に入れ替わる。
  - $A[j+1:n]$ も引き続きソートされている。
- 終了条件
  - ループは $j=i+1$ で終了する。
  - この時点で $A[i+1:n]$ はソート済みであり、最小の要素は $A[j+1]$ に位置している。


>c.bで証明したループ不変式の停止条件を用いて、不等式(2-5)の証明に繋がる。第1~4行の `for` ループに対するループ不等式を記述せよ。ただし、本章で示したループ不等式の証明の構造に従って証明すること。

- 初期条件
  - まだソートは開始されていないので、左端の 0 個の要素はソート済みとなる。
- ループ内条件
  - $A[j]<A[j−1]$ ならば、交換によって $A[j−1]$ と $A[j]$ が正しい位置に入れ替わる。その結果、新しい $A[j]$ は 左側の部分配列 $A[1:i]$ の最大要素より大きい（または等しい）ことが維持される。
- 終了条件
  - ループは $i=n−1$ で終了する。この時点で、 $A[1:n]$ 全体がソート済みである。


>d. $BUBLESORT$ の最悪実行時間を求めよ。挿入ソートの実行時間と比較せよ。

 $i$ の反復回数は、 $n-1$ 回。
 $j$ の反復回数は、 $n−(i+1)+1=n−i$ 回。

$$
T(n)= \sum\limits_{i=1}^{n-1} (n-i)=n(n-1) - \frac{n(n-1)}{2}=\frac{n(n-1)}{2}=0(n^2)
$$

実行時間は挿入ソートと同じになる。